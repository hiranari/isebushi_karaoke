# éŸ³å£°é–‹ç™ºã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

## ğŸš¨ **æœ€é‡è¦äº‹é …: Problemsæ’²æ»…ãƒãƒªã‚·ãƒ¼**

**ã™ã¹ã¦ã®éŸ³å£°é–¢é€£ä½œæ¥­ã§[Problemsæ’²æ»…ãƒãƒªã‚·ãƒ¼](./PROBLEMS_ZERO_POLICY.md)ã®å¼·åˆ¶éµå®ˆãŒå¿…è¦ã§ã™ã€‚**

- ğŸ”¥ **ä½œæ¥­é–‹å§‹å‰**: `flutter analyze --no-pub` ã§ `No issues found!` ç¢ºèªå¿…é ˆ  
- âš¡ **ä½œæ¥­ä¸­**: Problemsç™ºç”Ÿæ™‚ã¯å³åº§ã«è§£æ±º
- âœ… **ä½œæ¥­å®Œäº†å‰**: `flutter analyze --no-pub` ã§ `No issues found!` ç¢ºèªå¿…é ˆ

**éŸ³å£°å‡¦ç†ã®å“è³ªã¯ã‚³ãƒ¼ãƒ‰å“è³ªã‹ã‚‰å§‹ã¾ã‚Šã¾ã™ã€‚Problems 0ãŒçµ¶å¯¾æ¡ä»¶ã€‚**

---

## æ¦‚è¦

ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã¯ã€ä¼Šå‹¢ç¯€ã‚«ãƒ©ã‚ªã‚±ã‚¢ãƒ—ãƒªã®éŸ³å£°é–¢é€£æ©Ÿèƒ½é–‹ç™ºã«ãŠã‘ã‚‹çµ±ä¸€åŸºæº–ã‚’å®šç¾©ã—ã¾ã™ã€‚

## ğŸš€ **å®Ÿè£…ãƒ—ãƒ­ã‚»ã‚¹ï¼ˆå¿…é ˆï¼‰**

### ã‚¹ãƒ†ãƒƒãƒ—1: è©³ç´°ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆä½œæˆ

å®Ÿè£…å‰ã«ä»¥ä¸‹ã‚’å«ã‚€è©³ç´°ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã‚’å¿…ãšä½œæˆï¼š

**å¿…é ˆé …ç›®**:
- ğŸ“ **æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«**: ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æ–°è¦è¿½åŠ ã™ã‚‹ã‹ï¼ˆå…·ä½“çš„ãƒ‘ã‚¹ï¼‰
- âœï¸ **ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«**: ã©ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ã©ã‚“ãªä¿®æ­£ã‚’åŠ ãˆã‚‹ã‹ï¼ˆå…·ä½“çš„å†…å®¹ï¼‰
- ğŸ”— **å½±éŸ¿ç¯„å›²**: ä¿®æ­£ãŒä»–ã®ãƒ•ã‚¡ã‚¤ãƒ«ã«ä¸ãˆã‚‹å½±éŸ¿
- ğŸ§ª **ãƒ†ã‚¹ãƒˆè¨ˆç”»**: ä¿®æ­£å¾Œã®æ¤œè¨¼æ–¹æ³•
- âš ï¸ **ãƒªã‚¹ã‚¯è©•ä¾¡**: æ½œåœ¨çš„ãªå•é¡Œã¨ãã®å¯¾ç­–

**ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆä¾‹**:
```markdown
## Task: ãƒ”ãƒƒãƒæ¤œå‡ºç²¾åº¦å‘ä¸Š

### æ–°è¦ãƒ•ã‚¡ã‚¤ãƒ«
- `lib/core/audio/advanced_pitch_detector.dart` - é«˜ç²¾åº¦ãƒ”ãƒƒãƒæ¤œå‡ºå™¨
- `test/core/audio/advanced_pitch_detector_test.dart` - å¯¾å¿œãƒ†ã‚¹ãƒˆ

### ä¿®æ­£ãƒ•ã‚¡ã‚¤ãƒ«
- `lib/infrastructure/services/pitch_detection_service.dart`
  - L167-200: extractPitchFromAudio()ãƒ¡ã‚½ãƒƒãƒ‰ã®ç²¾åº¦æ”¹å–„
  - æ–°ã—ã„æ¤œå‡ºã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®çµ±åˆ
- `lib/domain/models/audio_analysis_result.dart`
  - L45: confidenceScoreãƒ—ãƒ­ãƒ‘ãƒ†ã‚£è¿½åŠ 

### å½±éŸ¿ç¯„å›²
- `lib/presentation/pages/karaoke_page.dart` - ãƒ”ãƒƒãƒè¡¨ç¤ºãƒ­ã‚¸ãƒƒã‚¯æ›´æ–°å¿…è¦
- æ—¢å­˜ãƒ†ã‚¹ãƒˆã‚±ãƒ¼ã‚¹ã®æ›´æ–°ãŒå¿…è¦

### ãƒ†ã‚¹ãƒˆè¨ˆç”»
- æ—¢å­˜WAVãƒ•ã‚¡ã‚¤ãƒ«ã§ã®ç²¾åº¦æ¯”è¼ƒãƒ†ã‚¹ãƒˆ
- ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†æ€§èƒ½ãƒ†ã‚¹ãƒˆ
```

### ã‚¹ãƒ†ãƒƒãƒ—2: UMLæ›´æ–°

ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã¨åˆã‚ã›ã¦é–¢é€£UMLã‚’æ›´æ–°ï¼š

**æ›´æ–°å¯¾è±¡**:
- ğŸ“Š **ã‚¯ãƒ©ã‚¹å›³**: æ–°è¦ã‚¯ãƒ©ã‚¹ã‚„æ—¢å­˜ã‚¯ãƒ©ã‚¹ã®å¤‰æ›´
- ğŸ”„ **ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å›³**: å‡¦ç†ãƒ•ãƒ­ãƒ¼ã®å¤‰æ›´ãŒã‚ã‚‹å ´åˆ
- ğŸ—ï¸ **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³**: ã‚·ã‚¹ãƒ†ãƒ æ§‹é€ ã®å¤‰æ›´ãŒã‚ã‚‹å ´åˆ

### ã‚¹ãƒ†ãƒƒãƒ—3: æ‰¿èªãƒ—ãƒ­ã‚»ã‚¹

**æ‰¿èªå¿…é ˆäº‹é …**:
1. è©³ç´°ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã®å†…å®¹ç¢ºèª
2. UMLæ›´æ–°å†…å®¹ã®ç¢ºèª
3. å®Ÿè£…æ–¹é‡ã®åˆæ„
4. ãƒªã‚¹ã‚¯è©•ä¾¡ã®å¦¥å½“æ€§ç¢ºèª

**æ‰¿èªå¾Œã«å®Ÿè£…é–‹å§‹** - æ‰¿èªå‰ã®å®Ÿè£…ã¯ç¦æ­¢

### ã‚¹ãƒ†ãƒƒãƒ—4: å®Ÿè£…ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³

- ğŸ“ ã‚¿ã‚¹ã‚¯ãƒªã‚¹ãƒˆã®é †ç•ªã«å¾“ã£ã¦å®Ÿè£…
- ğŸ”„ å„ã‚¹ãƒ†ãƒƒãƒ—å®Œäº†å¾Œã«é€²æ—å ±å‘Š
- âš ï¸ äºˆæœŸã—ãªã„å•é¡Œç™ºç”Ÿæ™‚ã¯å®Ÿè£…åœæ­¢ã—ã¦å†ç›¸è«‡

## ğŸ”§ **å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ãƒ»æ¤œè¨¼æ©Ÿèƒ½**

### **ãƒ”ãƒƒãƒæ¤œè¨¼ãƒ„ãƒ¼ãƒ«** ğŸ¯

**ãƒ„ãƒ¼ãƒ«ã®å ´æ‰€**:
```bash
tools/verification/pitch_verification_tool.dart
```

**ç”¨é€”**:
- WAVãƒ•ã‚¡ã‚¤ãƒ«ã®ãƒ”ãƒƒãƒæ¤œå‡ºç²¾åº¦æ¤œè¨¼
- åŸºæº–ãƒ”ãƒƒãƒãƒ‡ãƒ¼ã‚¿ã®å¤–éƒ¨ç”Ÿæˆ
- ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ”¹è‰¯æ™‚ã®æ¯”è¼ƒæ¤œè¨¼
- ã‚¯ãƒ­ã‚¹ãƒã‚§ãƒƒã‚¯ç”¨ã®ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹ç”Ÿæˆ

**å®Ÿè¡Œæ–¹æ³•**:
```bash
# åŸºæœ¬å®Ÿè¡Œ
cd tools/verification
dart pitch_verification_tool.dart ../../assets/sounds/Test.wav

# è©³ç´°ã‚ªãƒ—ã‚·ãƒ§ãƒ³
dart pitch_verification_tool.dart --help
```

**å‡ºåŠ›å½¢å¼**:
- ã‚³ãƒ³ã‚½ãƒ¼ãƒ«: çµ±è¨ˆæƒ…å ±ãƒ»ã‚µãƒãƒªãƒ¼
- ãƒ•ã‚¡ã‚¤ãƒ«: `verification_results/` ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªã«JSONå½¢å¼
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥: é«˜é€Ÿå†å®Ÿè¡Œå¯¾å¿œ

**æ´»ç”¨ã‚·ãƒ¼ãƒ³**:
- ğŸµ **æ–°ã—ã„æ¥½æ›²è¿½åŠ æ™‚**: åŸºæº–ãƒ”ãƒƒãƒã®äº‹å‰æ¤œè¨¼
- ğŸ”§ **ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ”¹è‰¯æ™‚**: Before/Afteræ¯”è¼ƒ
- ğŸ› **ãƒã‚°èª¿æŸ»æ™‚**: å¤–éƒ¨æ¤œè¨¼ã«ã‚ˆã‚‹å•é¡Œåˆ‡ã‚Šåˆ†ã‘
- ğŸ“Š **å“è³ªç¢ºèªæ™‚**: æ¤œå‡ºç²¾åº¦ã®å®šé‡è©•ä¾¡

**âš ï¸ é‡è¦**: å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã‚’å¿˜ã‚Œã¦ã—ã¾ã†å‰ã«ã€å¿…ãšã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã‚’ç¢ºèªã™ã‚‹ã“ã¨ï¼

### **åŸºæº–ãƒ”ãƒƒãƒç®—å‡ºãƒ„ãƒ¼ãƒ«** ğŸ“Š

**ãƒ„ãƒ¼ãƒ«ã®å ´æ‰€**:
```bash
tools/testing/test_reference_pitch.dart
```

**ç”¨é€”**:
- æ—¢å­˜ã®ãƒ”ãƒƒãƒæ¤œå‡ºã‚¨ãƒ³ã‚¸ãƒ³ã§ã®åŸºæº–ãƒ”ãƒƒãƒç®—å‡º
- ã‚­ãƒ£ãƒƒã‚·ãƒ¥æ©Ÿèƒ½ä»˜ãã§ã®é«˜é€Ÿå®Ÿè¡Œ
- çµ±è¨ˆæƒ…å ±ã®è©³ç´°å‡ºåŠ›

**å®Ÿè¡Œæ–¹æ³•**:
```bash
cd tools/testing
dart test_reference_pitch.dart ../../assets/sounds/Test.wav
dart test_reference_pitch.dart --no-cache  # ã‚­ãƒ£ãƒƒã‚·ãƒ¥ç„¡è¦–
```

### **CopilotDebugBridge** ğŸŒ‰

**ç”¨é€”**:
- ã‚«ãƒ©ã‚ªã‚±å®Ÿè¡Œä¸­ã®ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ‡ãƒãƒƒã‚°æƒ…å ±å‡ºåŠ›
- åŸºæº–ãƒ”ãƒƒãƒã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ ãƒ”ãƒƒãƒã®æ¯”è¼ƒ
- UIéä¾å­˜ã®ãƒ‡ãƒãƒƒã‚°æƒ…å ±åé›†

**ä½¿ç”¨æ–¹æ³•**:
```dart
// ã‚«ãƒ©ã‚ªã‚±ãƒšãƒ¼ã‚¸ã§ã®ä½¿ç”¨ä¾‹
CopilotDebugBridge.outputPitchInfo(
  referencePitches: referencePitches,
  currentPitch: currentPitch,
);
```

### **ğŸ”„ å¤–éƒ¨ãƒ„ãƒ¼ãƒ«æ´»ç”¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼**

#### **ãƒ‘ã‚¿ãƒ¼ãƒ³1: ãƒ”ãƒƒãƒæ¤œå‡ºå•é¡Œã®èª¿æŸ»**
```bash
# 1. å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã§åŸºæº–ãƒ”ãƒƒãƒç¢ºèª
cd tools/verification
dart pitch_verification_tool.dart ../../assets/sounds/Test.wav

# 2. çµæœã‚’verification_results/ã§ç¢ºèª
cat ../../verification_results/Test_verification_*.json

# 3. ã‚¢ãƒ—ãƒªå†…ã§ã®æ¤œå‡ºçµæœã¨æ¯”è¼ƒ
# ï¼ˆCopilotDebugBridgeã§ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡ºåŠ›ï¼‰

# 4. å·®ç•°ãŒã‚ã‚‹å ´åˆã¯ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ èª¿æ•´
```

#### **ãƒ‘ã‚¿ãƒ¼ãƒ³2: æ–°æ¥½æ›²ã®è¿½åŠ æ¤œè¨¼**
```bash
# 1. æ–°æ¥½æ›²ã®åŸºæº–ãƒ”ãƒƒãƒç®—å‡º
cd tools/testing
dart test_reference_pitch.dart ../../assets/sounds/NewSong.wav

# 2. ãƒ”ãƒƒãƒå“è³ªç¢ºèª
cd ../verification
dart pitch_verification_tool.dart ../../assets/sounds/NewSong.wav

# 3. çµ±è¨ˆæƒ…å ±ã®å¦¥å½“æ€§ç¢ºèª
# - æœ‰åŠ¹ç‡ > 80%
# - ãƒ”ãƒƒãƒç¯„å›²ãŒæ¥½æ›²ã®éŸ³åŸŸã¨ä¸€è‡´
# - ç•°å¸¸å€¤ï¼ˆoutlierï¼‰ã®æ¤œå‡º
```

#### **ãƒ‘ã‚¿ãƒ¼ãƒ³3: ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ æ”¹è‰¯ã®åŠ¹æœæ¸¬å®š**
```bash
# Before: æ”¹è‰¯å‰ã®çµæœã‚’ä¿å­˜
dart pitch_verification_tool.dart ../../assets/sounds/Test.wav > before_results.txt

# æ”¹è‰¯å®Ÿè£…...

# After: æ”¹è‰¯å¾Œã®çµæœã‚’æ¯”è¼ƒ
dart pitch_verification_tool.dart ../../assets/sounds/Test.wav > after_results.txt

# å·®åˆ†æ¯”è¼ƒã§æ”¹å–„åŠ¹æœã‚’ç¢ºèª
diff before_results.txt after_results.txt
```

---

## éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«å½¢å¼

### ã‚µãƒãƒ¼ãƒˆå½¢å¼
- **æ¨å¥¨**: WAVï¼ˆPCMã€16bitã€44.1kHzï¼‰
- **ç†ç”±**: ãƒ”ãƒƒãƒæ¤œå‡ºã®ç²¾åº¦ã¨å‡¦ç†é€Ÿåº¦ã®æœ€é©åŒ–

### éã‚µãƒãƒ¼ãƒˆå½¢å¼
- **MP3**: ãƒ‡ã‚³ãƒ¼ãƒ‰å‡¦ç†ã®è¤‡é›‘æ€§ã¨ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†ã¸ã®å½±éŸ¿
- **AAC/M4A**: åŒä¸Šã®ç†ç”±

## ãƒ‡ãƒãƒƒã‚°ã¨ãƒ­ã‚®ãƒ³ã‚°

### ğŸš« **çµ¶å¯¾ç¦æ­¢äº‹é …**

#### 1. printæ–‡ã®ä½¿ç”¨ã¯**ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§å´ä¸‹**
```dart
// âŒ çµ¶å¯¾ã«ä½¿ç”¨ç¦æ­¢ï¼ˆã‚³ãƒŸãƒƒãƒˆæ‹’å¦å¯¾è±¡ï¼‰
print('ãƒ‡ãƒãƒƒã‚°æƒ…å ±');
print('ã‚¨ãƒ©ãƒ¼: $error');
```

**é•åã—ãŸå ´åˆ**:
- **Problemsãƒ‘ãƒãƒ«ã«300+ã®è­¦å‘ŠãŒç™ºç”Ÿ**
- **ã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã§å³åº§ã«å´ä¸‹**
- **CI/CDãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³ã§ãƒ“ãƒ«ãƒ‰å¤±æ•—**
- **ãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ä½œæ¥­ãŒç„¡æ„å‘³ã«ãªã‚‹**

#### 2. ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ã®æœ¬ç•ªã‚³ãƒ¼ãƒ‰ä½¿ç”¨**ç¦æ­¢**
```dart
// âŒ çµ¶å¯¾ã«ä½¿ç”¨ç¦æ­¢ï¼ˆãƒ‡ãƒãƒƒã‚°æ··ä¹±ã®åŸå› ï¼‰
List<double> _generateMockPitches() {
  return [261.63, 293.66, 329.63]; // ä»®æƒ³ãƒ‡ãƒ¼ã‚¿
}

// âœ… æ¨å¥¨å®Ÿè£…ï¼ˆå®Ÿãƒ‡ãƒ¼ã‚¿ä½¿ç”¨ï¼‰
List<double> _extractRealPitches(String wavFile) {
  return actualPitchDetection.analyze(wavFile);
}
```

**ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‡ãƒ¼ã‚¿ä½¿ç”¨æ™‚ã®å•é¡Œ**:
- **æ¤œè¨¼çµæœã®ä¿¡é ¼æ€§ä½ä¸‹**
- **å®Ÿéš›ã®å•é¡Œã®éš è”½**
- **ãƒ‡ãƒãƒƒã‚°åŠ¹ç‡ã®å¤§å¹…ä½ä¸‹**
- **æœ¬ç•ªç’°å¢ƒã§ã®äºˆæœŸã—ãªã„å‹•ä½œ**

**ä¾‹å¤–çš„ãªä½¿ç”¨**:
- **å˜ä½“ãƒ†ã‚¹ãƒˆå†…ã®ã¿**: ãƒ†ã‚¹ãƒˆå°‚ç”¨ãƒ‡ãƒ¼ã‚¿ã¨ã—ã¦ä½¿ç”¨å¯èƒ½
- **ä¸€æ™‚çš„ãªãƒ‡ãƒãƒƒã‚°**: ä½¿ç”¨å¾Œã¯**å¿…ãšå‰Šé™¤**
- **ãƒ—ãƒ­ãƒˆã‚¿ã‚¤ãƒ—æ®µéš**: å®Ÿè£…å®Œäº†æ™‚ã«**å®Ÿãƒ‡ãƒ¼ã‚¿ã«ç½®ãæ›ãˆ**

#### 3. è‡ªå‹•æ¤œè¨¼ã®è¿½åŠ 

ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³é•åã‚’é˜²ããŸã‚ã€ä»¥ä¸‹ã®è‡ªå‹•ãƒã‚§ãƒƒã‚¯ã‚’å°å…¥ï¼š

**VS Codeè¨­å®šãƒ•ã‚¡ã‚¤ãƒ« (.vscode/settings.json)**:
```json
{
  "dart.lineLength": 120,
  "dart.showLintWarnings": true,
  "flutter.previewEmbeddedAndroidViews": true,
  "files.autoSave": "onFocusChange",
  "editor.codeActionsOnSave": {
    "source.fixAll": true
  },
  "problems.decorations.enabled": true
}
```

**åˆ†æã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼·åŒ– (analysis_options.yaml)**:
```yaml
analyzer:
  errors:
    avoid_print: error  # printæ–‡ã‚’ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«ã«æ˜‡æ ¼
    unused_local_variable: error
    
linter:
  rules:
    avoid_print: true
    prefer_const_constructors: true
```

#### 3. æ¨å¥¨ä»£æ›¿æ‰‹æ®µï¼ˆå¼·åˆ¶ï¼‰

**ãƒ¬ãƒ™ãƒ«1: åŸºæœ¬ãƒ‡ãƒãƒƒã‚°**ï¼ˆå¿…é ˆï¼‰:
```dart
// âœ… åŸºæœ¬çš„ãªãƒ‡ãƒãƒƒã‚°å‡ºåŠ›ï¼ˆå¿…é ˆï¼‰
if (kDebugMode) {
  debugPrint('ãƒ‡ãƒãƒƒã‚°æƒ…å ±');
}
```

**ãƒ¬ãƒ™ãƒ«2: æ§‹é€ åŒ–ãƒ­ã‚°**ï¼ˆæ¨å¥¨ï¼‰:
```dart
// âœ… ã‚¨ãƒ©ãƒ¼ãƒ¬ãƒ™ãƒ«åˆ¥ãƒ­ã‚°ï¼ˆæ¨å¥¨ï¼‰
import 'package:your_app/core/utils/debug_logger.dart';

DebugLogger.info('å‡¦ç†å®Œäº†');
DebugLogger.warning('è­¦å‘Šç™ºç”Ÿ');
DebugLogger.error('ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ', error, stackTrace);
```

**ãƒ¬ãƒ™ãƒ«3: Copiloté€£æºãƒ­ã‚°**ï¼ˆæœ€æ¨å¥¨ï¼‰:
```dart
// âœ… CopilotãŒè‡ªå‹•ç›£è¦–å¯èƒ½ï¼ˆæœ€æ¨å¥¨ï¼‰
import 'package:your_app/core/utils/copilot_debug_bridge.dart';

CopilotDebugBridge.setState('current_status', 'processing');
CopilotDebugBridge.reportError('AudioService', 'ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å¤±æ•—');
CopilotDebugBridge.reportPerformance('pitch_detection', duration);
```

### ğŸ”§ **ãƒ„ãƒ¼ãƒ«ã‚¹ã‚¯ãƒªãƒ—ãƒˆã§ã®ä¾‹å¤–**

é–‹ç™ºãƒ„ãƒ¼ãƒ«ï¼ˆ`tools/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªï¼‰ã§ã¯ã€ä»¥ä¸‹ã®æ¡ä»¶ä¸‹ã§printæ–‡ã‚’è¨±å¯ï¼š

1. **ã‚¹ã‚¯ãƒªãƒ—ãƒˆå®Ÿè¡Œæ™‚ã®é€²æ—è¡¨ç¤º**
2. **ä¸€å›é™ã‚Šã®åˆ†æçµæœå‡ºåŠ›**
3. **æ‰‹å‹•å®Ÿè¡ŒãŒå‰æã®è¨ºæ–­ãƒ„ãƒ¼ãƒ«**

```dart
// tools/scripts/ å†…ã§ã¯è¨±å¯
void main() {
  print('ğŸ” WAVãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼é–‹å§‹...');
  // å‡¦ç†...
  print('âœ… æ¤œè¨¼å®Œäº†');
}
```

## ã‚³ãƒ¼ãƒ‰ã‚¯ãƒªãƒ¼ãƒ³åŒ–

### æœªä½¿ç”¨å¤‰æ•°ã®å‰Šé™¤

```dart
// âŒ é¿ã‘ã‚‹ã¹ãå®Ÿè£…
final dataSize = view.getUint32(40, Endian.little); // ä½¿ç”¨ã•ã‚Œã¦ã„ãªã„

// âœ… æ¨å¥¨å®Ÿè£…ï¼ˆä½¿ç”¨ã™ã‚‹å ´åˆï¼‰
final dataSize = view.getUint32(40, Endian.little);
validateDataSize(dataSize);

// âœ… æ¨å¥¨å®Ÿè£…ï¼ˆä¸è¦ãªå ´åˆï¼‰
// final dataSize = view.getUint32(40, Endian.little); // å‰Šé™¤
```

### constå®£è¨€ã®å¾¹åº•

```dart
// âŒ é¿ã‘ã‚‹ã¹ãå®Ÿè£…
final EdgeInsets padding = EdgeInsets.all(8.0);

// âœ… æ¨å¥¨å®Ÿè£…
const EdgeInsets padding = EdgeInsets.all(8.0);
```

## éŸ³å£°å‡¦ç†ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹

### ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡¦ç†
- å‡¦ç†æ™‚é–“: 100msä»¥ä¸‹ã‚’ç›®æ¨™
- ãƒ¡ãƒ¢ãƒªä½¿ç”¨é‡: æœ€å°é™ã«æŠ‘åˆ¶
- ã‚¬ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³é »åº¦: å‰Šæ¸›

### ã‚­ãƒ£ãƒƒã‚·ãƒ¥æˆ¦ç•¥
- é »ç¹ã«ã‚¢ã‚¯ã‚»ã‚¹ã•ã‚Œã‚‹ãƒ”ãƒƒãƒãƒ‡ãƒ¼ã‚¿ã®ã‚­ãƒ£ãƒƒã‚·ãƒ¥
- ãƒ¡ãƒ¢ãƒªåŠ¹ç‡çš„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®ä½¿ç”¨

## ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°

### éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«é–¢é€£ã‚¨ãƒ©ãƒ¼
```dart
try {
  final audioData = await loadAudioFile(path);
} on AudioException catch (e, stackTrace) {
  DebugLogger.error('éŸ³å£°ãƒ•ã‚¡ã‚¤ãƒ«èª­ã¿è¾¼ã¿å¤±æ•—', e, stackTrace);
  CopilotDebugBridge.reportError('AudioLoader', e.message, 
    context: {'file_path': path});
  // ãƒ¦ãƒ¼ã‚¶ãƒ¼å‘ã‘é©åˆ‡ãªã‚¨ãƒ©ãƒ¼ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
}
```

## ãƒ†ã‚¹ãƒˆæˆ¦ç•¥

### éŸ³å£°å‡¦ç†ãƒ†ã‚¹ãƒˆ
- ãƒ¦ãƒ‹ãƒƒãƒˆãƒ†ã‚¹ãƒˆ: å€‹åˆ¥æ©Ÿèƒ½ã®æ¤œè¨¼
- çµ±åˆãƒ†ã‚¹ãƒˆ: éŸ³å£°å‡¦ç†ãƒ‘ã‚¤ãƒ—ãƒ©ã‚¤ãƒ³å…¨ä½“
- ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ†ã‚¹ãƒˆ: ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ€§èƒ½æ¤œè¨¼

## ã¾ã¨ã‚

ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«å¾“ã†ã“ã¨ã§ï¼š
- **é–‹ç™ºåŠ¹ç‡å‘ä¸Š**: Problemsãƒ‘ãƒãƒ«ã®è­¦å‘Šå‰Šæ¸›
- **ä¿å®ˆæ€§å‘ä¸Š**: ä¸€è²«ã—ãŸãƒ­ã‚°æˆ¦ç•¥
- **ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹å‘ä¸Š**: æœ€é©åŒ–ã•ã‚ŒãŸãƒ‡ãƒãƒƒã‚°æ‰‹æ³•
- **Copiloté€£æº**: åŠ¹ç‡çš„ãªãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

---

## ğŸ“š **ã‚¯ã‚¤ãƒƒã‚¯ãƒªãƒ•ã‚¡ãƒ¬ãƒ³ã‚¹**

### **å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ä¸€è¦§**

| **ãƒ„ãƒ¼ãƒ«** | **ãƒ‘ã‚¹** | **ç”¨é€”** | **å®Ÿè¡Œä¾‹** |
|-----------|---------|---------|-----------|
| **ãƒ”ãƒƒãƒæ¤œè¨¼** | `tools/verification/pitch_verification_tool.dart` | WAVãƒ•ã‚¡ã‚¤ãƒ«æ¤œè¨¼ | `dart pitch_verification_tool.dart ../../assets/sounds/Test.wav` |
| **åŸºæº–ãƒ”ãƒƒãƒç®—å‡º** | `tools/testing/test_reference_pitch.dart` | åŸºæº–ãƒ‡ãƒ¼ã‚¿ç”Ÿæˆ | `dart test_reference_pitch.dart ../../assets/sounds/Test.wav` |
| **ãƒ‡ãƒãƒƒã‚°ãƒ–ãƒªãƒƒã‚¸** | `lib/core/debug/copilot_debug_bridge.dart` | ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ å‡ºåŠ› | `CopilotDebugBridge.outputPitchInfo(...)` |

### **ç·Šæ€¥æ™‚ã‚³ãƒãƒ³ãƒ‰**

```bash
# Problemsæ’²æ»…ï¼ˆæœ€å„ªå…ˆï¼‰
flutter analyze --no-pub

# ãƒ†ã‚¹ãƒˆå®Ÿè¡Œï¼ˆProblemsæ’²æ»…ã¨åŒç­‰ã«é‡è¦ï¼‰
flutter test

# å¤–éƒ¨ãƒ”ãƒƒãƒæ¤œè¨¼ï¼ˆå¿˜ã‚ŒãŒã¡ï¼‰
cd tools/verification && dart pitch_verification_tool.dart ../../assets/sounds/Test.wav

# ã‚­ãƒ£ãƒƒã‚·ãƒ¥ã‚¯ãƒªã‚¢
flutter clean && flutter pub get

# å®Œå…¨ãƒªã‚»ãƒƒãƒˆï¼ˆç·Šæ€¥æ™‚ï¼‰
flutter clean && flutter pub get && flutter analyze --no-pub && flutter test
```

### **ãƒ†ã‚¹ãƒˆå¤±æ•—æ™‚ã®å¯¾å‡¦æ³•**

| **ã‚¨ãƒ©ãƒ¼ãƒ‘ã‚¿ãƒ¼ãƒ³** | **åŸå› ** | **è§£æ±ºç­–** |
|------------------|---------|-----------|
| `Service of type ILogger is not registered` | Service Locatoræœªè¨­å®š | ãƒ†ã‚¹ãƒˆãƒ•ã‚¡ã‚¤ãƒ«ã«setUp()ã§loggerç™»éŒ² |
| `type 'DebugFileLogger' is not a subtype` | å‹ã‚­ãƒ£ã‚¹ãƒˆå¤±æ•— | EnhancedDebugLoggerä½¿ç”¨ |
| `Bad state: No element` | ProvideråˆæœŸåŒ–å¤±æ•— | Service LocatoråˆæœŸåŒ– |

### **ã‚ˆãã‚ã‚‹å¤±æ•—ãƒ‘ã‚¿ãƒ¼ãƒ³**

| **å¤±æ•—** | **åŸå› ** | **è§£æ±ºç­–** |
|---------|---------|-----------|
| ğŸš¨ å¤–éƒ¨ãƒ„ãƒ¼ãƒ«å¿˜ã‚Œ | ã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³æœªç¢ºèª | **å¿…ãšã“ã®ãƒ•ã‚¡ã‚¤ãƒ«ã‚’æœ€åˆã«ç¢ºèª** |
| ğŸš¨ print()ä½¿ç”¨ | ç¿’æ…£çš„ãªä½¿ç”¨ | debugPrint()ã«å¼·åˆ¶å¤‰æ› |
| ğŸš¨ Problemsç™ºç”Ÿ | ã‚³ãƒ¼ãƒ‰å“è³ªä½ä¸‹ | flutter analyze ã§å³åº§è§£æ±º |
| ğŸš¨ **ãƒ†ã‚¹ãƒˆå®Ÿè¡Œå¿˜ã‚Œ** | **ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼æœªç¿’æ…£åŒ–** | **ä½œæ¥­å‰å¾Œã®å¿…é ˆãƒã‚§ãƒƒã‚¯** |
| ğŸš¨ æ¤œè¨¼çµæœä¸ä¸€è‡´ | ã‚­ãƒ£ãƒƒã‚·ãƒ¥å•é¡Œ | --no-cache ã‚ªãƒ—ã‚·ãƒ§ãƒ³ä½¿ç”¨ |
| ğŸš¨ **å¤§é‡ãƒ†ã‚¹ãƒˆå¤±æ•—** | **ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¤‰æ›´æ™‚ã®ãƒ†ã‚¹ãƒˆæœªæ›´æ–°** | **å¤‰æ›´æ™‚ã¯å¿…ãšãƒ†ã‚¹ãƒˆå®Ÿè¡Œ** |

### **ğŸ¯ å¿˜ã‚Œé˜²æ­¢å¯¾ç­–**

#### **1. ä½œæ¥­é–‹å§‹å‰ã®å¼·åˆ¶ãƒã‚§ãƒƒã‚¯**
```bash
# ã“ã®3ã‚³ãƒãƒ³ãƒ‰ã‚’å¿…ãšå®Ÿè¡Œ
flutter analyze --no-pub && echo "âœ… Analysis OK"
flutter test && echo "âœ… Tests OK" 
echo "ğŸš€ ä½œæ¥­é–‹å§‹å¯èƒ½"
```

#### **2. ä½œæ¥­å®Œäº†å‰ã®å¼·åˆ¶ãƒã‚§ãƒƒã‚¯**
```bash
# å¤‰æ›´å¾Œã¯å¿…ãšå®Ÿè¡Œ
flutter test && flutter analyze --no-pub && echo "âœ… å®Œäº†OK"
```

#### **3. VS Codeè¨­å®šã§ã®è‡ªå‹•åŒ–**
```json
// .vscode/tasks.json ã«è¿½åŠ æ¨å¥¨
{
  "label": "Pre-work Check",
  "type": "shell",
  "command": "flutter analyze --no-pub && flutter test",
  "group": "build"
}
```

### **é–‹ç™ºãƒ•ãƒ­ãƒ¼ï¼ˆæ¨å¥¨ï¼‰**

1. **ğŸ“‹ ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ç¢ºèª** â† **ã“ã®ãƒ•ã‚¡ã‚¤ãƒ«**
2. **ğŸ” flutter analyze** ï¼ˆProblems 0ç¢ºèªï¼‰
3. **ğŸ§ª flutter test** ï¼ˆ**å…¨ãƒ†ã‚¹ãƒˆæˆåŠŸç¢ºèª - çµ¶å¯¾å¿…é ˆï¼**ï¼‰
4. **ğŸ¯ å¤–éƒ¨ãƒ„ãƒ¼ãƒ«å®Ÿè¡Œ** ï¼ˆå¿…è¦ã«å¿œã˜ã¦ï¼‰
5. **âš¡ å®Ÿè£…ä½œæ¥­**
6. **ğŸ§ª flutter test** ï¼ˆ**å¤‰æ›´å¾Œãƒ†ã‚¹ãƒˆå®Ÿè¡Œ - çµ¶å¯¾å¿…é ˆï¼**ï¼‰
7. **âœ… flutter analyze** ï¼ˆProblems 0ç¢ºèªï¼‰

**ğŸš¨ é‡è¦**: ãƒ†ã‚¹ãƒˆå®Ÿè¡Œã‚’å¿˜ã‚Œã‚‹ã¨ã€ãƒ­ã‚°ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å¤‰æ›´ãªã©ã§å¤§é‡ã®ãƒ†ã‚¹ãƒˆå¤±æ•—ã‚’è¦‹é€ƒã™ï¼

### **ä½œæ¥­å‰ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆï¼ˆå¿…é ˆï¼‰**

```bash
# Step 1: Problems 0ç¢ºèª
flutter analyze --no-pub
# çµæœ: "No issues found!" ä»¥å¤–ã¯ä½œæ¥­ç¦æ­¢

# Step 2: ãƒ†ã‚¹ãƒˆçŠ¶æ³ç¢ºèª
flutter test
# çµæœ: å¤±æ•—ãŒã‚ã‚Œã°å„ªå…ˆä¿®æ­£

# Step 3: å¤–éƒ¨ãƒ„ãƒ¼ãƒ«å‹•ä½œç¢ºèª
cd tools/verification && dart pitch_verification_tool.dart ../../assets/sounds/Test.wav
# çµæœ: åŸºæº–å€¤ã¨ã®æ•´åˆæ€§ç¢ºèª
```

**âš ï¸ ã“ã‚Œã‚‰ã‚’å®Ÿè¡Œã—ãªã„ã§ä½œæ¥­é–‹å§‹ã™ã‚‹ã®ã¯ç¦æ­¢ï¼**

**ğŸ¯ é‡è¦**: å¤–éƒ¨ãƒ„ãƒ¼ãƒ«ã®å­˜åœ¨ã‚’å¿˜ã‚ŒãŸã‚‰ã€å¿…ãšã“ã®ã‚¬ã‚¤ãƒ‰ãƒ©ã‚¤ãƒ³ã«æˆ»ã‚‹ã“ã¨ï¼
